Description: CVE-2013-2030 Nova uses insecure keystone middleware tmpdir by default
 Grant Murphy from Red Hat and Anton Lundin both independently reported a
 vulnerability in Nova default location for the Keystone middleware signing
 directory (signing_dir). By previously setting up a malicious directory
 structure, an attacker with local shell access on the Nova node could
 potentially issue forged tokens that would be accepted by the middleware.
 Only setups that use the default value for signing_dir are affected. Note that
 future versions of the Keystone middleware will issue a warning if an insecure
 signing directory is used.
Author: Russell Bryant <rbryant@redhat.com>
Origin: upstream, https://review.openstack.org/#/c/28569/
Bug-Ubuntu: https://bugs.launchpad.net/nova/+bug/1174608
Bug-Debian: http://bugs.debian.org/707600
Last-Update: 2013-05-10

--- nova-2013.1.orig/etc/nova/api-paste.ini
+++ nova-2013.1/etc/nova/api-paste.ini
@@ -104,6 +104,9 @@ auth_protocol = http
 admin_tenant_name = %SERVICE_TENANT_NAME%
 admin_user = %SERVICE_USER%
 admin_password = %SERVICE_PASSWORD%
-signing_dir = /tmp/keystone-signing-nova
+# signing_dir is configurable, but the default behavior of the authtoken
+# middleware should be sufficient.  It will create a temporary directory
+# in the home directory for the user the nova process is running as.
+#signing_dir = /var/lib/nova/keystone-signing
 # Workaround for https://bugs.launchpad.net/nova/+bug/1154809
 auth_version = v2.0
